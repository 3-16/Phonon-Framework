"use strict";!function(e,t,n,a){function i(){if(C){var e=H.indexOf(C.name),t=G(H[e-1]);return t?t.name:k.name}return k.name}function o(e,n){if(O=!0,Q=!1,H.push(e),C&&(k=C,T=t.getElementById(C.name)),C=G(e),L=t.getElementById(C.name),!C)throw new Error(e+" does not have a namespace, please use Navigator.on() function");if(P===C.name&&H.length>1&&(j=!0,H=[P]),k&&k.name===C.name)return void(O=!1);var a=L.querySelector(".content");null!==a&&0!==a.scrollTop&&(a.scrollTop=0),U(L,C,n),C.asynchronous||c()}function r(){null!==R&&(T.classList.remove("page-sliding"),T.classList.remove("left"),T.removeEventListener(R,r,!1)),T.classList.remove("app-active"),W(T,k),V(L,C),O=!1}function s(){null!==R&&(T.classList.remove("page-sliding"),T.classList.remove("right"),T.removeEventListener(R,s,!1)),T.classList.remove("app-active"),W(T,k),V(L,C),O=!1}function c(){return k===a||k.name===C.name?void(O=!1):(j?(L.classList.add("app-active"),R?(T.classList.add("page-sliding"),T.classList.add("right"),T.addEventListener(R,s,!1)):s()):(L.classList.add("app-active"),R?(T.classList.add("page-sliding"),T.classList.add("left"),T.addEventListener(R,r,!1)):r(T)),void(j=!1))}function l(){if(C.activity!==a&&C.activity.onReadyCallback!==a){var e=t.getElementById(C.name),n=location.hash.substr(2),i=_(C.route),o=S(n,i);C.activity.onReadyCallback({startTransition:c,getMessage:p},e,o)}}function u(){b(i())}function f(){Q=!1}function p(){for(var e=A.length,t=e-1;t>=0;t--){var n=A[t];if(n.receiver===C.name)return A.splice(t,1),n.message}}function d(e,t){A.push({sender:C.name,receiver:e,message:t})}function v(e){if("boolean"!=typeof e)throw new Error("The parameter must be a boolean, "+typeof e+" given");e?(R="webkitAnimationEnd",n.animationEnd&&(R=n.animationEnd)):R=null}function h(n){if(N)throw new Error("The first page has already been instantiated");var a=G(n);if(!a)throw new Error(n+" does not have a namespace, please use Navigator.on() function");var i=t.getElementById(n);i.classList.contains("app-active")||i.classList.add("app-active"),e.location.hash==="#!"+n?o(n):e.location.hash="#!"+n,N=!0}function m(){return C.name}function g(){return k.name}function y(e,t,n){if("string"!=typeof e.page)throw new TypeError("page name must be a string");if(e.asynchronous===a&&(e.asynchronous=!1),"boolean"!=typeof e.asynchronous)throw new TypeError("asynchronous must be a boolean");if("function"!=typeof t)throw new TypeError("callback must be a function");I(e,t,n)}function b(t,n){if("string"!=typeof t)throw new TypeError("page name must be a string");if(!O){if(t===C.name&&console.error("The current page is already "+t),!G(t))throw new Error(t+" does not have a namespace, please use Navigator.on() function");var i=n===a?t:t+"/"+n;i=i.replace("//","/"),e.location.hash="#!"+i}}function w(t){if("object"!=typeof t)throw new TypeError("config must be an object");if("string"!=typeof t.defaultPage)throw new TypeError("default page is not set");P=t.defaultPage,t.templatePath!==a&&D(t.templatePath),e.Phonon&&e.Phonon.Panel&&(B=!0),t.pageAnimations===!1&&(R=null),t.panels&&(t.panels.autoClose!==a&&(B=t.panels.autoClose),t.panels.path&&(x=t.panels.path)),t.hammer!==a&&"string"==typeof t.hammer.path?ee(t.hammer.path,t.hammer.tapOptions):ee()}var E,C,k,L,T,P,x,R,M=function(){function e(){this._isCreated=!1}return e.prototype.isCreated=function(){return this._isCreated},e.prototype.onCreate=function(e){var t=this;this.onCreateCallback=function(n,a,i){t._isCreated=!0,e(n,a,i)}},e.prototype.onReady=function(e){this.onReadyCallback=function(t,n,a){e(t,n,a)}},e.prototype.onQuit=function(e){this.onQuitCallback=function(t){e(t)}},e.prototype.onHidden=function(e){this.onHidenCallback=function(t){e(t)}},e.prototype.onTransitionEnd=function(e){this.onTransitionEndCallback=function(){e()}},e}(),N=!1,q=[],H=[],O=!1,A=[],Q=!1,j=!1,B=!1,I=function(e,t,n){var i={name:e.page,template:e.template,asynchronous:e.asynchronous,route:n,callback:t};n===a&&(i.route=e.page),q.push(i)},G=function(e){var t,n=q.length-1;for(t=n;t>=0;t--){var i=q[t];if(i.name===e)return i}return a},S=function(e,t){var n=new RegExp(t.regex).exec(e);if(null===n)return!1;var a={};for(var i in t.groups)a[i]=n[t.groups[i]+1];return a},_=function(e){for(var t=new RegExp(":([^/.\\\\]+)","g"),n=e,a={},i=null,o=0;i=t.exec(e);)a[i[1]]=o++,n=n.replace(i[0],"([^/.\\\\]+)");return n+="$",{groups:a,regex:n}},$=function(){var t,n=e.location.hash.substr(2),a=q.length;for(t=a-1;t>=0;t--){var i=q[t];if(i.name===(n.substring(0,n.indexOf("/"))||n)){if(i.name!==i.route){var r=S(n,_(i.route));o(i.name,r)}else o(i.name);break}}},D=function(e){if("string"!=typeof e)throw new TypeError("path must be a string");var t=-1!==e.indexOf("/",e.length-"/".length);t||(e+="/"),E=e},X=function(e,t){var n=new XMLHttpRequest,i=E===a?e:E+e;n.open("GET",i+".html",!0),n.overrideMimeType("text/html; charset=utf-8"),n.onreadystatechange=function(){if(4==n.readyState){if(200!=n.status)return void console.error("The template file could not be loaded, please check that the file exists");t(n.responseText)}},n.send()},Y=function(n){for(var o=null,r=n.target?n.target:n.toElement;r&&r!==t;r=r.parentNode){var s=r.getAttribute("data-navigation"),c=r.getAttribute("data-param");if(null!==s){"$previous-page"===s?(j=!0,o=i(),0!==o.indexOf("#!")&&(o="#!"+o)):o=0!==s.indexOf("#!")?"#!"+s:s,c&&(o=o+"/"+c);break}if(r.attributes.href!==a&&null!==r.attributes.href.value){var l=0!==r.attributes.href.value.indexOf("#!");if(!l){o=r.attributes.href.value;break}}}o&&(C.activity!==a&&C.activity.onQuitCallback!==a?Z():e.location.hash=o),o=null},z=function(){P===C.name||Q||(Q=!0,j=!0,C.activity!==a&&C.activity.onQuitCallback!==a?Z():u())},F=function(){if(B)if("function"==typeof require){if(!x)return void console.error("config.panels.cancelClose is true, but the AMD path to Phonon Panels is not set");require([x],function(e){var t=e.Panel?e.Panel:e;t().closeLastPanel()||z()})}else{var e=n.Panel?n.Panel:n;e().closeLastPanel()||z()}else z()},J=function(e){for(var t=e.querySelectorAll("a, button"),n=t.length-1,a=n;a>=0;a--){var i=t[a],o=i.getAttribute("data-autotext");o&&("textContent"in i?i.textContent=k.name:i.innerText=k.name)}},K=function(e,t,n){t.callback!==a&&t.callback(t.activity),t.activity!==a&&t.activity.onCreateCallback!==a&&t.activity.onCreateCallback({runReady:l,getMessage:p},e,n),t.activity!==a&&t.activity.onReadyCallback!==a&&t.asynchronous===!1&&setTimeout(function(){t.activity.onReadyCallback({startTransition:c,getMessage:p},e,n)},50)},U=function(e,t,n){if(t!==a){var i=t.hasOwnProperty("activity");i?t.activity!==a&&t.activity.onReadyCallback!==a&&t.activity.onReadyCallback({startTransition:c,getMessage:p},e,n):(t.activity=new M,t.template!==a?X(t.template,function(a){e.innerHTML=a,J(e),K(e,t,n)}):(J(e),K(e,t,n)))}},V=function(e,t){t!==a&&t.activity!==a&&t.activity.onTransitionEndCallback!==a&&t.activity.onTransitionEndCallback()},W=function(e,t){t!==a&&t.activity!==a&&t.activity.onHidenCallback!==a&&t.activity.onHidenCallback(e)},Z=function(){C.activity.onQuitCallback({quit:u,cancel:f})},ee=function(e,n){var a=n||{};if("undefined"!=typeof Hammer){var i=new Hammer(t.body).on("tap",Y,!1);i.get("tap").set(a)}else"function"==typeof require?require([e],function(e){if("undefined"!=typeof e){var n=new e(t.body).on("tap",Y,!1);n.get("tap").set(a)}else t.addEventListener("click",Y,!1)}):t.addEventListener("click",Y,!1)},te={};if(te.setMessage=d,te.animatePages=v,te.start=h,te.getCurrentPage=m,te.getPreviousPage=g,te.on=y,te.changePage=b,te.init=w,!("onhashchange"in e))throw new Error("Your browser does not support the hashchange event");e.addEventListener("hashchange",$),t.addEventListener("backbutton",F),v(!0),n.Navigator=function(e){return"object"==typeof e&&w(e),te},e.Phonon=n,"function"==typeof define&&define.amd&&define(function(){return n.returnGlobalNamespace===!0?n:n.Navigator}),"object"==typeof module&&module.exports&&(module.exports=n.returnGlobalNamespace===!0?n:n.Navigator)}(window,document,window.Phonon||{});