"use strict";!function(t,e,n,i){function r(){var t=e.querySelector(".app-page.app-active");null!==t.querySelector("div.backdrop-menu")&&t.removeChild(f),s.style.visibility="hidden"}function o(t,n){var r="string"==typeof t?e.querySelector(t):t;if(null===r)throw new Error("The menu with ID "+t+" does not exist");if((n===i||"left"!==n&&"title"!==n&&"right"!==n)&&(n="left"),c=!0,r.style.visibility="visible",s=r,!r.classList.contains("active")){var o=e.querySelector(".app-page.app-active");if("title"===n){var a=o.querySelector(".header-bar");r.style.top=(a?a.clientHeight:48)+"px",r.style.left=e.body.clientWidth/2-r.clientWidth/2+"px",r.setAttribute("class","menu on-title")}else r.style.top="12px","left"===n?r.style.left="16px":(r.style.left="auto",r.style.right="16px");r.classList.toggle("active"),o.appendChild(f)}}function a(n){var i="string"==typeof n?e.querySelector(n):n;if(null===i)throw new Error("The menu with ID "+n+" does not exist");c=!1,s=i,i.classList.contains("active")&&(i.classList.toggle("active"),t.setTimeout(function(){r()},250))}function u(t){var n="string"==typeof t?e.querySelector(t):t;if(null===n)throw new Error("The menu with ID "+t+" does not exist");n.classList.contains("active")?a(n):o(n)}var l=!1,s=!1,c=!1,f=e.createElement("div");f.classList.add("backdrop-menu");var d=function(t){for(var n={target:null,id:null,direction:null};t&&t!==e;t=t.parentNode)if(null!==t.getAttribute("data-menu-id")){n.target=t,n.id=t.getAttribute("data-menu-id"),n.direction="left",t.classList.contains("pull-right")&&(n.direction="right"),t.classList.contains("title")&&(n.direction="title");break}return n},p=function(t){for(var n,i=e.querySelectorAll(".menu");t&&t!==e;t=t.parentNode)for(n=i.length;n--;)if(i[n]===t&&t.classList.contains("active"))return t};t.addEventListener("touchstart",function(t){t=t.originalEvent||t;var e=p(t.target);!e&&c&&a(s),l=!1}),t.addEventListener("touchmove",function(t){t=t.originalEvent||t,l=!0}),t.addEventListener("touchend",function(t){var n=t.target?t.target:t.toElement,i=d(t.target);if(i.target){var r=e.querySelector("#"+i.id);r&&(r.classList.contains("active")&&!l?a(r):o(r,i.direction))}s!==n.parentNode.parentNode||l||a(s)}),n.Menu=function(t){var n="string"==typeof t?e.querySelector(t):t;if(null===n)throw new Error("The menu with ID "+t+" does not exist");return{open:function(t){var e=function(){return t.apply(this,arguments)};return e.toString=function(){return t.toString()},e}(function(){return o(n),this}),close:function(t){var e=function(){return t.apply(this,arguments)};return e.toString=function(){return t.toString()},e}(function(){return a(n),this}),toggle:function(t){var e=function(){return t.apply(this,arguments)};return e.toString=function(){return t.toString()},e}(function(){return u(n),this})}},t.Phonon=n,"function"==typeof define&&define.amd?define(function(){return n.returnGlobalNamespace===!0?n:n.Menu}):"object"==typeof module&&module.exports&&(module.exports=n.returnGlobalNamespace===!0?n:n.Menu)}(window,document,window.Phonon||{});